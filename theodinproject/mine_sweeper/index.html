<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title> Insert Title</title>
    <!-- bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-2.2.4.js" integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI=" crossorigin="anonymous"></script>
    <!-- jQuery UI -->
    <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js" integrity="sha256-DI6NdAhhFRnO2k51mumYeDShet3I8AKCQf/tf7ARNhI=" crossorigin="anonymous"></script>
    <!-- bootstrap jquery -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

    <!--local-->
    <!-- <link href="css/main.css" rel="stylesheet"> -->
    <!-- <script type="text/javascript"></script> -->

    <!-- table#main_table>(tr#row1>td#$$$@101.unclicked.empty*9)+(tr#row2>td#$$$@201.unclicked.empty*9)+(tr#row3>td#$$$@301.unclicked.empty*9)+(tr#row4>td#$$$@401.unclicked.empty*9)+(tr#row5>td#$$$@501.unclicked.empty*9)+(tr#row6>td#$$$@601.unclicked.empty*9)+(tr#row7>td#$$$@701.unclicked.empty*9)+(tr#row8>td#$$$@801.unclicked.empty*9)+(tr#row9>td#$$$@901.unclicked.empty*9) -->
  </head>
  <body>
    <table id="main_table">
      <tr id="row1">
        <td id="101" class="unclicked empty"></td>
        <td id="102" class="unclicked empty"></td>
        <td id="103" class="unclicked empty"></td>
        <td id="104" class="unclicked empty"></td>
        <td id="105" class="unclicked empty"></td>
        <td id="106" class="unclicked empty"></td>
        <td id="107" class="unclicked empty"></td>
        <td id="108" class="unclicked empty"></td>
        <td id="109" class="unclicked empty"></td>
      </tr>
      <tr id="row2">
        <td id="201" class="unclicked empty"></td>
        <td id="202" class="unclicked empty"></td>
        <td id="203" class="unclicked empty"></td>
        <td id="204" class="unclicked empty"></td>
        <td id="205" class="unclicked empty"></td>
        <td id="206" class="unclicked empty"></td>
        <td id="207" class="unclicked empty"></td>
        <td id="208" class="unclicked empty"></td>
        <td id="209" class="unclicked empty"></td>
      </tr>
      <tr id="row3">
        <td id="301" class="unclicked empty"></td>
        <td id="302" class="unclicked empty"></td>
        <td id="303" class="unclicked empty"></td>
        <td id="304" class="unclicked empty"></td>
        <td id="305" class="unclicked empty"></td>
        <td id="306" class="unclicked empty"></td>
        <td id="307" class="unclicked empty"></td>
        <td id="308" class="unclicked empty"></td>
        <td id="309" class="unclicked empty"></td>
      </tr>
      <tr id="row4">
        <td id="401" class="unclicked empty"></td>
        <td id="402" class="unclicked empty"></td>
        <td id="403" class="unclicked empty"></td>
        <td id="404" class="unclicked empty"></td>
        <td id="405" class="unclicked empty"></td>
        <td id="406" class="unclicked empty"></td>
        <td id="407" class="unclicked empty"></td>
        <td id="408" class="unclicked empty"></td>
        <td id="409" class="unclicked empty"></td>
      </tr>
      <tr id="row5">
        <td id="501" class="unclicked empty"></td>
        <td id="502" class="unclicked empty"></td>
        <td id="503" class="unclicked empty"></td>
        <td id="504" class="unclicked empty"></td>
        <td id="505" class="unclicked empty"></td>
        <td id="506" class="unclicked empty"></td>
        <td id="507" class="unclicked empty"></td>
        <td id="508" class="unclicked empty"></td>
        <td id="509" class="unclicked empty"></td>
      </tr>
      <tr id="row6">
        <td id="601" class="unclicked empty"></td>
        <td id="602" class="unclicked empty"></td>
        <td id="603" class="unclicked empty"></td>
        <td id="604" class="unclicked empty"></td>
        <td id="605" class="unclicked empty"></td>
        <td id="606" class="unclicked empty"></td>
        <td id="607" class="unclicked empty"></td>
        <td id="608" class="unclicked empty"></td>
        <td id="609" class="unclicked empty"></td>
      </tr>
      <tr id="row7">
        <td id="701" class="unclicked empty"></td>
        <td id="702" class="unclicked empty"></td>
        <td id="703" class="unclicked empty"></td>
        <td id="704" class="unclicked empty"></td>
        <td id="705" class="unclicked empty"></td>
        <td id="706" class="unclicked empty"></td>
        <td id="707" class="unclicked empty"></td>
        <td id="708" class="unclicked empty"></td>
        <td id="709" class="unclicked empty"></td>
      </tr>
      <tr id="row8">
        <td id="801" class="unclicked empty"></td>
        <td id="802" class="unclicked empty"></td>
        <td id="803" class="unclicked empty"></td>
        <td id="804" class="unclicked empty"></td>
        <td id="805" class="unclicked empty"></td>
        <td id="806" class="unclicked empty"></td>
        <td id="807" class="unclicked empty"></td>
        <td id="808" class="unclicked empty"></td>
        <td id="809" class="unclicked empty"></td>
      </tr>
      <tr id="row9">
        <td id="901" class="unclicked empty"></td>
        <td id="902" class="unclicked empty"></td>
        <td id="903" class="unclicked empty"></td>
        <td id="904" class="unclicked empty"></td>
        <td id="905" class="unclicked empty"></td>
        <td id="906" class="unclicked empty"></td>
        <td id="907" class="unclicked empty"></td>
        <td id="908" class="unclicked empty"></td>
        <td id="909" class="unclicked empty"></td>
      </tr>
    </table>
  </body>
  <style>
    td {
      padding: 22px;
      /*width: 45px;*/
      /*height: 45px;*/
      border: 1px solid red;
      background-color: white;

    }
    .bomb {
      background-color: red;
    }
    .unclicked{
      background-color: gray;
      opacity: 0.7;
    }
    .flag{
      background-color: blue !important;
      /*color: red;*/
      /*top: 0;*/
      /*line-height: 0;*/

    }
  </style>

  <script type="text/javascript">
    $(function(){
      var arr = [];
      var sampleArr = [509,609,306,404,808,404,608,703,404,703];
      //chooseBomb generates random 10 bombs and displays them
      var chooseBomb = function(){
        var genRandomNum = function(){
          var num1 = Math.floor(Math.random()*9+1)*100;
          var num2 = Math.floor(Math.random()*9+1);
          return num1 + num2;
        }
        arr = [genRandomNum(),genRandomNum(),genRandomNum(),genRandomNum(),genRandomNum(),genRandomNum(),genRandomNum(),genRandomNum(),genRandomNum(),genRandomNum()];
        $.each(arr, function(index,value){
          $("#"+value).addClass("bomb").text("B").removeClass('empty');
        });
      };
      //run chooseBomb() when document.ready
      chooseBomb();

      //isTouching will count how many bombs each square is touching
      var isTouching = function(){
        // this is every <td> element_id on the page
        var grid = [101,102,103,104,105,106,107,108,109,201,202,203,204,205,206,207,208,209,301,302,303,304,305,306,307,308,309,401,402,403,404,405,406,407,408,409,501,502,503,504,505,506,507,508,509,601,602,603,604,605,606,607,608,609,701,702,703,704,705,706,707,708,709,801,802,803,804,805,806,807,808,809,901,902,903,904,905,906,907,908,909];

        // iterate through grid, finding all 8 <td>'s that are touching
        $.each(grid, function(index,value){
          var displayNum = 0;
          var a = value + 1;
          var b = value - 1;
          var c = value + 99;
          var d = value + 100;
          var e = value + 101;
          var f = value - 99;
          var g = value - 100;
          var h = value - 101;
          var arr1 = [a,b,c,d,e,f,g,h]; 
          // iterate through the new arr1, to see if any of them .hasClass('bomb')
          $.each(arr1, function(index1,value1){
            if ($("#"+value1).hasClass("bomb")){
              // update the displayNum if found
              displayNum++;
            }
          });
          // if bomb has been found
          if (displayNum > 0){
            // check if the orginal <td> contain a bomb itself
            if (!$("#"+value).hasClass("bomb")){
              $("#"+value).text(displayNum.toString()).removeClass("empty");
            }
          } 
        });
      };
      //run isTouching() when document.ready
      isTouching();

      // when clicked
      $('td').on("click", function(e){
        var $num = $("#"+e.target.id);
        var targetNo = e.target.id;
        $num.removeClass('unclicked');
        console.log($num);
        if ($num.hasClass('bomb')){
          alert("game over");
        } else if ($num.hasClass('touching')){
          $num.removeClass('unclicked');
        } else {
          var loopPositive = function(timesBy){
            var keepGoing = true;
            var traverseNo = 0;
            while (keepGoing){
              var num2 = parseInt(targetNo) + (traverseNo*timesBy);
              var $num3 = $("#"+num2);
              console.log(num2 + " and "+ $num3);
              if (!$num3.hasClass('bomb') && traverseNo < 9){
                $num3.removeClass('unclicked');
                traverseNo++;
                // console.log("if");
              } else if ($num3.hasClass('touching') && traverseNo < 9){
                traverseNo = 8;
              } else {
                keepGoing = false;
                // console.log('false');
              } // else
            } //while(keepGoing)
          } //loop positive
          // loopPositive(100);
          var loopNegative = function(){
            var keepGoing = true;
            var traverseNo = 0;
            var timesBy = 1;
            while (keepGoing){
              var num2 = parseInt(targetNo) - (traverseNo*timesBy);
              var $num3 = $("#"+num2);
              if (!$num3.hasClass('bomb') && traverseNo < 9){
                var keepGoing1 = true;
                var traverseNo1 = 0;
                var timesBy1 = 100;
                var num2 = parseInt(targetNo) - (traverseNo1*timesBy);
                var $num3 = $("#"+num2);
                while (keepGoing){
                  if (!$num3.hasClass('bomb') && traverseNo1 < 9){
                    $num3.removeClass('unclicked');
                    traverseNo++;
                  } else if ($num3.hasClass('touching') && traverseNo1 < 9){
                    traverseNo1 = 8;
                  } else {
                    keepGoing1 = false;
                  } // else
                $num3.removeClass('unclicked');
                traverseNo++;
              } else if ($num3.hasClass('touching') && traverseNo < 9){
                traverseNo = 8;
              } else {
                keepGoing = false;
              } // else
            }
            } //while(keepGoing)
          } //loop negative
          // loopNegative(100);
          var loop = function(){
            loopPositive(1);
            loopNegative(1);
            function(){
              loopPositive(100);
              loopNegative(100);
            }
          };


        // loop(100, 1, 100);



          // up
          //   right
          //     up
          //       right
          //       left
          //     down
          //       right 
          //       left 
          //   left
          //     up
          //       right
          //       left
          //     down
          //       right 
          //       left 

          // down
          //   right
          //     up
          //       right 
          //       left
          //     down 
          //       right 
          //       left
          //   left
          //     up
          //       right
          //       left
          //     down
          //       right 
          //       left 



        }
      });
      
      // when Right-clicked, .addClass("flag")
      $('td').bind("contextmenu", function(e){
        e.preventDefault();
        $("#"+e.target.id).toggleClass("flag");
        // $("#"+e.target.id).toggleClass("flag glyphicon glyphicon-flag");
      });
      

    });
  </script>
</html>

<!--
  var clearBox = function(param2){
    var num2 = e.target.id;

        for (var a=0; a<9; a++){
          var by100 = a*100;

          for (var i=0; i<9; i++){
            var $num3 = $("#"+(parseInt(num2) + by100 + i));
            console.log($num3);
            if ($num3.hasClass('empty')){
              $num3.removeClass('unclicked');
            } else {
              i = 9;
            }
          } //for i
          for (var j=0; j<9; j++){
            var $num3 = $("#"+(parseInt(num2) + by100 - j));
            console.log("var j "+$num3)
            if ($num3.hasClass('empty')){
              $num3.removeClass('unclicked');
            } else {
              j = 9;
            }
          } //for j
        } //for a

      };  //clearBox()

    -->

    <!--
            var clearSideways = function(direction){
          
          for (var i=1; i<9; i++){
            if($num3.hasClass('empty')){
              $num3.removeClass('unclicked');
            } else {
              i = 9;
            }
          } //for i
        };
      -->


